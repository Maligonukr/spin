!function(c){var l="lwpscModal",a={type:"html",content:"",url:"",ajax:{},ajaxRequest:null,closeOnEsc:!0,closeOnOverlayClick:!0,clone:!1,overlay:{block:void 0,tpl:'<div class="'+l+'-overlay"></div>',css:{backgroundColor:"#000",opacity:.6,zIndex:1e5}},container:{block:void 0,tpl:'<div class="'+l+'-container"><div class="'+l+'-container_i"><div class="'+l+'-container_i2"></div></div></div>'},preloader:{verticalAlign:void 0,tpl:'<div class="'+l+'-preloader" />'},wrap:void 0,body:void 0,errors:{tpl:'<div class="'+l+"-error "+l+'-close"></div>',autocloseDelay:2e3,ajaxUnsuccessfulLoad:"Error"},openEffect:{type:"fade",speed:400},closeEffect:{type:"fade",speed:400},width:"auto",verticalAlign:"middle",beforeOpen:c.noop,afterOpen:c.noop,beforeClose:c.noop,afterClose:c.noop,afterLoading:c.noop,afterLoadingOnShow:c.noop,errorLoading:c.noop},s=0,d=c([]),f=function(e,a){var t=!0;return c(e).each(function(){c(a.target).get(0)==c(this).get(0)&&(t=!1),0==c(a.target).closest("HTML",c(this).get(0)).length&&(t=!1)}),t},o={getParentEl:function(e){var a=c(e);return a.data(l)?a:(a=c(e).closest("."+l+"-container").data(l+"ParentEl"))||!1},transition:function(e,a,t,n){switch(n=null==n?c.noop:n,t.type){case"fade":"show"==a?e.fadeIn(t.speed,n):e.fadeOut(t.speed,n);break;case"none":"show"==a?e.show():e.hide(),n()}},setWrapMarginRight:function(e,a){e.wrap.css("marginRight",a+"px"),c(document).trigger(l+"_setWrapMarginRight",a)},initEl:function(a,e){var t=a.data(l);if(!t){if(s++,(t=e).modalID=s,t.overlay.block=c(t.overlay.tpl),t.overlay.block.css(t.overlay.css),t.container.block=c(t.container.tpl),t.body=c("."+l+"-container_i2",t.container.block),e.clone?t.body.html(a.clone(!0)):(a.before('<div id="'+l+"Reserve"+t.modalID+'" style="display: none" />'),t.body.html(a)),t.body.on("click","."+l+"-close",function(){return a[l]("close"),!1}),t.closeOnOverlayClick&&t.overlay.block.add(t.container.block).click(function(e){f(c(">*",t.body),e)&&a[l]("close")}),t.container.block.data(l+"ParentEl",a),a.data(l,t),d=c.merge(d,a),c.proxy(p.show,a)(),"html"==t.type)return a;if(null!=t.ajax.beforeSend){var n=t.ajax.beforeSend;delete t.ajax.beforeSend}if(null!=t.ajax.success){var o=t.ajax.success;delete t.ajax.success}if(null!=t.ajax.error){var i=t.ajax.error;delete t.ajax.error}var r=c.extend(!0,{url:t.url,beforeSend:function(){t.body.html(t.preloader.tpl).css("verticalAlign",void 0===t.preloader.verticalAlign?t.verticalAlign:t.preloader.verticalAlign),void 0!==n&&n(t,a)},success:function(e){a.trigger("afterLoading."+l),e=t.afterLoading(t,a,e)||e,t.body.css("verticalAlign",t.verticalAlign),null==o?t.body.html(e):o(t,a,e),a.trigger("afterLoadingOnShow."+l),t.afterLoadingOnShow(t,a,e)},error:function(){a.trigger("errorLoading."+l),t.errorLoading(t,a),null==i?(t.body.html(t.errors.tpl),c("."+l+"-error",t.body).html(t.errors.ajaxUnsuccessfulLoad),c("."+l+"-close",t.body).click(function(){return a[l]("close"),!1}),t.errors.autocloseDelay&&setTimeout(function(){a[l]("close")},t.errors.autocloseDelay)):i(t,a)}},t.ajax);t.ajaxRequest=c.ajax(r),a.data(l,t)}},init:function(e){return e=c.extend(!0,{},a,e),c.isFunction(this)?null==e?void c.error(l+": Uncorrect parameters"):""!=e.url?(e.type="ajax",o.initEl(c("<div />"),e)):""!=e.content?(e.type="html",o.initEl(c(e.content),e)):void c.error(l+': Set parameter "url" or "content"'):this.each(function(){o.initEl(c(this),c.extend(!0,{},e))})}},p={show:function(){var e=o.getParentEl(this);if(!1!==e){var a=e.data(l);if(a.overlay.block.hide(),a.container.block.hide(),c("BODY").append(a.overlay.block),c("BODY").append(a.container.block),a.container.block.css("zIndex",a.overlay.block.css("zIndex")),a.beforeOpen(a,e),e.trigger("beforeOpen."+l),"hidden"!=a.wrap.css("overflow-y")){a.wrap.data(l+"Overflow",a.wrap.css("overflow-y"));var t=a.wrap.outerWidth(!0);a.wrap.css("overflow-y","hidden");var n=a.wrap.outerWidth(!0);n!=t&&o.setWrapMarginRight(a,n-t)}return d.not(e).each(function(){c(this).data(l).overlay.block.hide()}),a.body.css("verticalAlign",a.verticalAlign),a.body.parent().css("width",a.width),o.transition(a.overlay.block,"show",1<d.length?{type:"none"}:a.openEffect),o.transition(a.container.block,"show",1<d.length?{type:"none"}:a.openEffect,function(){a.afterOpen(a,e),e.trigger("afterOpen."+l)}),e}c.error(l+": Uncorrect call")},close:function(){if(!c.isFunction(this))return this.each(function(){var e=o.getParentEl(this);if(!1!==e){var a=e.data(l);!1!==a.beforeClose(a,e)&&(e.trigger("beforeClose."+l),d.not(e).last().each(function(){c(this).data(l).overlay.block.show()}),o.transition(a.overlay.block,"hide",1<d.length?{type:"none"}:a.closeEffect),o.transition(a.container.block,"hide",1<d.length?{type:"none"}:a.closeEffect,function(){a.afterClose(a,e),e.trigger("afterClose."+l),a.clone||c("#"+l+"Reserve"+a.modalID).replaceWith(a.body.find(">*")),a.overlay.block.remove(),a.container.block.remove(),e.data(l,null),c("."+l+"-container").length||(a.wrap.data(l+"Overflow")&&a.wrap.css("overflow-y",a.wrap.data(l+"Overflow")),o.setWrapMarginRight(a,0))}),"ajax"==a.type&&a.ajaxRequest.abort(),d=d.not(e))}else c.error(l+": Uncorrect call")});d.each(function(){c(this)[l]("close")})},getActive:function(){var e=c("."+l+"-container").last();return!!e.length&&e.data(l+"ParentEl").data(l)},setDefault:function(e){c.extend(!0,a,e)}};c(function(){a.wrap=c(document.all&&!document.querySelector?"html":"body")}),c(document).bind("keyup."+l,function(e){var a=d.last();a.length&&a.data(l).closeOnEsc&&27===e.keyCode&&a[l]("close")}),c[l]=c.fn[l]=function(e){return p[e]?p[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void c.error(l+": Method "+e+" does not exist"):o.init.apply(this,arguments)}}(jQuery),function(n){var o="lwpscAjaxForm",a={afterInit:n.noop,beforeSend:n.noop,success:n.noop,error:function(){alert("Failed to execute the query. Reload the page and try again.")},b:{}},i={isForm:function(e){return"form"==e.get(0).tagName.toLowerCase()},makeData:function(e){return i.isForm(e)?e.serialize():(a=e.clone().wrap("<form/>"),e.find("select").each(function(e){a.find("select").eq(e).val(n(this).val())}),a.serialize());var a},submit:function(e,a){n.ajax({type:"POST",cache:!1,data:i.makeData(e),url:i.isForm(e)?e.attr("action"):e.data("action"),beforeSend:function(){a.beforeSend(a,e)},success:function(e){a.b.container.html(e),a.success(a)},error:function(){a.error(a,e)}})},initContainer:function(e,a){var t=e.data(o);t||(t=a,e.data(o,t),(t.b.container=e).on("submit","[data-ajax-form]",function(){return i.submit(n(this),t),!1}),t.afterInit(t))},init:function(e){return e=n.extend(!0,{},a,e),n.isFunction(this)?(n.error(o+": Uncorrect call"),!1):this.each(function(){i.initContainer(n(this),n.extend(!0,{},e))})}},t={setDefault:function(e){n.extend(!0,a,e)}};n[o]=n.fn[o]=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(n.error(o+": Method "+e+" does not exist"),!1):i.init.apply(this,arguments)}}(jQuery),function(a){var t="lwpscPreloader";a.fn[t+"Show"]=function(){var e=a(this);e.addClass(t+"Wrapper"),e.append('<div class="'+t+'Overlay"><div class="lwpscDarkSpinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>')},a.fn[t+"Hide"]=function(){var e=a(this);e.removeClass(t+"Wrapper"),e.find("."+t+"Overlay").remove()}}(jQuery),function(o){o(function(){var e=o(".lwpscManage"),n=e.find(".lwpscManage_area"),t=n.find(".lwpscManage_items");t.sortable({handle:".lwpscManage_item_sortHandle",axis:"y",revert:200,connectWith:".lwpscManage_items",stop:function(){var a=[];n.each(function(){var e=o(this).data("id");o(this).find(".lwpscManage_item").each(function(){a.push(o(this).data("id")+","+e)})}),o.ajax({url:lwpscMain.ajaxUrl,method:"POST",data:{action:"lwpsc_sort",data:a}})}}),e.find(".lwpscManage_add .button").click(function(){o.lwpscModal({url:lwpscMain.ajaxUrl,closeOnOverlayClick:!1,ajax:{data:{action:"lwpsc_add_item",areaId:o(this).closest(".lwpscManage_area").data("id")}},afterLoadingOnShow:function(e){e.body.lwpscAjaxForm({afterInit:function(e){e.b.container.find('INPUT[type="text"]').focus()},beforeSend:function(e){e.b.container.find(".lwpscModalBox").lwpscPreloaderShow()},success:function(e){e.b.container.find(".lwpscModalBox").length||e.b.container.lwpscModal("close")}})}})}),o(document).on("lwpscItemCreated",function(e,a){var t=n.filter('[data-id="'+a.areaId+'"]').find(".lwpscManage_items");t.length&&t.append(a.html)}),t.on("click",".lwpscManage_item_edit",function(){o.lwpscModal({url:lwpscMain.ajaxUrl,closeOnOverlayClick:!1,ajax:{data:{action:"lwpsc_edit_item",id:o(this).closest(".lwpscManage_item").data("id")}},afterLoadingOnShow:function(e){e.body.lwpscAjaxForm({afterInit:function(e){e.b.container.find('INPUT[type="text"]').focus()},beforeSend:function(e){e.b.container.find(".lwpscModalBox").lwpscPreloaderShow()},success:function(e){e.b.container.find(".lwpscModalBox").length||e.b.container.lwpscModal("close")}})}})}),o(document).on("lwpscItemUpdated",function(e,a){t.find('.lwpscManage_item[data-id="'+a.id+'"]').replaceWith(a.html)}),t.on("click",".lwpscManage_item_disable,.lwpscManage_item_enable",function(){var a=o(this).closest(".lwpscManage_item"),t=a.closest(".lwpscManage_area");o.ajax({url:lwpscMain.ajaxUrl,data:{action:"lwpsc_"+(o(this).hasClass("lwpscManage_item_disable")?"disable":"enable")+"_item",id:a.data("id")},beforeSend:function(){t.lwpscPreloaderShow()},success:function(e){a.replaceWith(e),t.lwpscPreloaderHide()}})}),t.on("click",".lwpscManage_item_delete",function(){o.lwpscModal({url:lwpscMain.ajaxUrl,closeOnOverlayClick:!1,ajax:{data:{action:"lwpsc_delete_item",id:o(this).closest(".lwpscManage_item").data("id")}},afterLoadingOnShow:function(e){e.body.lwpscAjaxForm({beforeSend:function(e){e.b.container.find(".lwpscModalBox").lwpscPreloaderShow()},success:function(e){e.b.container.find(".lwpscModalBox").length||e.b.container.lwpscModal("close")}})}})}),t.on("click",".lwpscManage_deletedItem_hide",function(){o(this).closest(".lwpscManage_deletedItem").animate({opacity:0,height:0,paddingTop:0,paddingBottom:0},{complete:function(){o(this).remove()}})}),o(document).on("lwpscItemDeleted",function(e,a){t.find('.lwpscManage_item[data-id="'+a.id+'"]').replaceWith(a.html)})}),o(function(){var e=o(".lwpscRate");e.length&&e.on("click",".button",function(){o.ajax({url:lwpscMain.ajaxUrl,method:"POST",data:{action:o(this).data("action")},beforeSend:function(){e.lwpscPreloaderShow()},success:function(){e.remove()}})})})}(jQuery);